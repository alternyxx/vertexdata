from os import chdir, path
from vertexdata import VertexParser, NOPOSITIONDATA

CUBE = """-1.000000, 1.000000, -1.000000, -0.0000, 1.0000, -0.0000,
1.000000, 1.000000, 1.000000, -0.0000, 1.0000, -0.0000,
1.000000, 1.000000, -1.000000, -0.0000, 1.0000, -0.0000,
1.000000, 1.000000, 1.000000, -0.0000, -0.0000, 1.0000,
-1.000000, -1.000000, 1.000000, -0.0000, -0.0000, 1.0000,
1.000000, -1.000000, 1.000000, -0.0000, -0.0000, 1.0000,
-1.000000, 1.000000, 1.000000, -1.0000, -0.0000, -0.0000,
-1.000000, -1.000000, -1.000000, -1.0000, -0.0000, -0.0000,
-1.000000, -1.000000, 1.000000, -1.0000, -0.0000, -0.0000,
1.000000, -1.000000, -1.000000, -0.0000, -1.0000, -0.0000,
-1.000000, -1.000000, 1.000000, -0.0000, -1.0000, -0.0000,
-1.000000, -1.000000, -1.000000, -0.0000, -1.0000, -0.0000,
1.000000, 1.000000, -1.000000, 1.0000, -0.0000, -0.0000,
1.000000, -1.000000, 1.000000, 1.0000, -0.0000, -0.0000,
1.000000, -1.000000, -1.000000, 1.0000, -0.0000, -0.0000,
-1.000000, 1.000000, -1.000000, -0.0000, -0.0000, -1.0000,
1.000000, -1.000000, -1.000000, -0.0000, -0.0000, -1.0000,
-1.000000, -1.000000, -1.000000, -0.0000, -0.0000, -1.0000,
-1.000000, 1.000000, -1.000000, -0.0000, 1.0000, -0.0000,
-1.000000, 1.000000, 1.000000, -0.0000, 1.0000, -0.0000,
1.000000, 1.000000, 1.000000, -0.0000, 1.0000, -0.0000,
1.000000, 1.000000, 1.000000, -0.0000, -0.0000, 1.0000,
-1.000000, 1.000000, 1.000000, -0.0000, -0.0000, 1.0000,
-1.000000, -1.000000, 1.000000, -0.0000, -0.0000, 1.0000,
-1.000000, 1.000000, 1.000000, -1.0000, -0.0000, -0.0000,
-1.000000, 1.000000, -1.000000, -1.0000, -0.0000, -0.0000,
-1.000000, -1.000000, -1.000000, -1.0000, -0.0000, -0.0000,
1.000000, -1.000000, -1.000000, -0.0000, -1.0000, -0.0000,
1.000000, -1.000000, 1.000000, -0.0000, -1.0000, -0.0000,
-1.000000, -1.000000, 1.000000, -0.0000, -1.0000, -0.0000,
1.000000, 1.000000, -1.000000, 1.0000, -0.0000, -0.0000,
1.000000, 1.000000, 1.000000, 1.0000, -0.0000, -0.0000,
1.000000, -1.000000, 1.000000, 1.0000, -0.0000, -0.0000,
-1.000000, 1.000000, -1.000000, -0.0000, -0.0000, -1.0000,
1.000000, 1.000000, -1.000000, -0.0000, -0.0000, -1.0000,
1.000000, -1.000000, -1.000000, -0.0000, -0.0000, -1.0000,
"""

NORMALS = """-0.0000, 1.0000, -0.0000,
-0.0000, 1.0000, -0.0000,
-0.0000, 1.0000, -0.0000,
-0.0000, -0.0000, 1.0000,
-0.0000, -0.0000, 1.0000,
-0.0000, -0.0000, 1.0000,
-1.0000, -0.0000, -0.0000,
-1.0000, -0.0000, -0.0000,
-1.0000, -0.0000, -0.0000,
-0.0000, -1.0000, -0.0000,
-0.0000, -1.0000, -0.0000,
-0.0000, -1.0000, -0.0000,
1.0000, -0.0000, -0.0000,
1.0000, -0.0000, -0.0000,
1.0000, -0.0000, -0.0000,
-0.0000, -0.0000, -1.0000,
-0.0000, -0.0000, -1.0000,
-0.0000, -0.0000, -1.0000,
-0.0000, 1.0000, -0.0000,
-0.0000, 1.0000, -0.0000,
-0.0000, 1.0000, -0.0000,
-0.0000, -0.0000, 1.0000,
-0.0000, -0.0000, 1.0000,
-0.0000, -0.0000, 1.0000,
-1.0000, -0.0000, -0.0000,
-1.0000, -0.0000, -0.0000,
-1.0000, -0.0000, -0.0000,
-0.0000, -1.0000, -0.0000,
-0.0000, -1.0000, -0.0000,
-0.0000, -1.0000, -0.0000,
1.0000, -0.0000, -0.0000,
1.0000, -0.0000, -0.0000,
1.0000, -0.0000, -0.0000,
-0.0000, -0.0000, -1.0000,
-0.0000, -0.0000, -1.0000,
-0.0000, -0.0000, -1.0000,
"""

# im sorry to whoever thought this would have unit tests
class TestCube:
    chdir(path.dirname(__file__)) # changes to the tests folder so Cube.triangulated.obj can be read
    cube = ''
    with open("test_cube.obj") as file:
        cube = file.read()
    
    def test_cube(self, tmp_path) -> None:
        temp_path = tmp_path / 'temp' # making a temporary folder to output the cubeobj
        temp_path.mkdir()
        CubeOBJ = temp_path / 'Cube.obj'
        
        vd: VertexParser = VertexParser(
            self.cube, CubeOBJ
        )
        vd.parse()
        vd.output_file()
        assert CubeOBJ.read_text() == CUBE
    
    def test_normals(self) -> None:
        vd: VertexParser = VertexParser(
            self.cube, '', False, NOPOSITIONDATA
        )
        vd.parse()
        assert vd.output() == NORMALS